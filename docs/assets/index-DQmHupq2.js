!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class t{constructor(t,e){this.elParentGrab=t,this.classItems=this.elParentGrab.dataset.jsortClassItems??".jsort-item",this.classHandler=this.elParentGrab.dataset.jsortClassHandler??".jsort-handler",this.duration=this.elParentGrab.dataset.jsortDuration??420,this.swap="true"===this.elParentGrab.dataset.jsortSwap,this.easing=this.elParentGrab.dataset.jsortEasing??"cubic-bezier(0.6, 0, 0.6, 1)",this.scale=this.elParentGrab.dataset.jsortScale??"1.1",this.zIndex=Number(this.elParentGrab.dataset.jsortZindex??2147483647),this.scrollSpeed=Number(this.elParentGrab.dataset.jsortScrollSpeed??10),this.edgeThreshold=Number(this.elParentGrab.dataset.jsortEdgeThreshold??50),this.group=this.elParentGrab.dataset.jsortGroup,this.init(e)}appendGhost(){const{x:t,y:e,width:s,height:i}=this.elGrabbed.getBoundingClientRect();this.elGhost=this.elGrabbed.cloneNode(!0),Object.assign(this.elGhost.style,{position:"fixed",left:`${t}px`,top:`${e}px`,width:`${s}px`,height:`${i}px`,pointerEvents:"none",zIndex:this.zIndex,opacity:.8}),this.elGhost.classList.add("jsort-ghost"),this.elGhost.animate([{scale:this.scale}],{duration:250,easing:this.easing,fill:"forwards"}),this.elParentGrab.append(this.elGhost)}animateItem({el:t,x:e,y:s}){const{left:i,top:r}=t.getBoundingClientRect();if(e===i&&s===r)return;t.classList.add("is-jsort-animated");const l=t===this.elGrabbed?[{position:"relative",zIndex:1,translate:`${e-i}px ${s-r}px`,opacity:.9,scale:this.scale},{position:"relative",zIndex:1,translate:"0",opacity:1,scale:1}]:[{position:"relative",zIndex:0,scale:1,translate:`${e-i}px ${s-r}px`},{position:"relative",zIndex:0,scale:2-this.scale},{position:"relative",zIndex:0,scale:1,translate:"0"}],n=t.animate(l,{duration:this.duration,easing:this.easing,fill:"forwards"});n.addEventListener("finish",()=>{t.classList.remove("is-jsort-animated"),n.cancel()})}closestElement(t,e){for(;t&&t!==e;)t=t.parentElement;return t===e?t:null}checkValidity({clientX:t,clientY:e}){const s=document.elementFromPoint(t,e),i=s?.closest(`${this.classItems}, .jsort`),r=s?.closest(".jsort"),l=i&&this.closestElement(i,this.elGrabbed)===this.elGrabbed,n=r===this.elParentGrab,o=r?.dataset.jsortGroup,a=!n&&Boolean(o&&this.group===o);return!l&&i&&r&&a||n}engine(t,e=60){const s=1e3/e;let i=0,r=null;const l=()=>{r=requestAnimationFrame(l);const e=performance.now(),n=e-i;if(n<s)return;i=e-n%s,t()},n=()=>{cancelAnimationFrame(r),r=null,i=0};return{start:()=>{n(),i=performance.now(),r=requestAnimationFrame(l)},stop:n,tick:l}}findScrollParent(t){for(;t&&t!==document.documentElement;){const e=window.getComputedStyle(t);if(t.scrollHeight>t.clientHeight&&("auto"===e.overflowY||"scroll"===e.overflowY))return t;t=t.parentElement}return document.documentElement}scrollStep(){this.scrollDirection&&("up"===this.scrollDirection?this.scrollParent.scrollTop-=this.scrollSpeed:"down"===this.scrollDirection?this.scrollParent.scrollTop+=this.scrollSpeed:"left"===this.scrollDirection?this.scrollParent.scrollLeft-=this.scrollSpeed:"right"===this.scrollDirection&&(this.scrollParent.scrollLeft+=this.scrollSpeed))}startEdgeScroll(t){this.scrollDirection!==t&&(this.scrollDirection=t,this.scrollAnim||(this.scrollAnim=this.engine(this.scrollStep.bind(this)),this.scrollAnim.start()))}stopEdgeScroll(){this.scrollDirection=null,this.scrollAnim&&(this.scrollAnim.stop(),this.scrollAnim=null)}handleScrollParent(t){this.scrollParent||(this.scrollParent=this.findScrollParent(this.elGrabbed));const e=this.scrollParent.getBoundingClientRect(),s=document.documentElement,i=this.scrollParent===s,r=i?0:e.top,l=i?window.innerHeight:e.bottom,n=i?0:e.left,o=i?window.innerWidth:e.left;t.clientY<r+this.edgeThreshold?this.startEdgeScroll("up"):t.clientY>l-this.edgeThreshold?this.startEdgeScroll("down"):t.clientX<n+this.edgeThreshold?this.startEdgeScroll("left"):t.clientX>o-this.edgeThreshold?this.startEdgeScroll("right"):this.stopEdgeScroll()}grab=t=>{if(this.elGrabbed)return;const e=t.target.closest(`${this.classItems}`);if(!e)return;if(e.parentElement!==this.elParentGrab)return;const s=e.querySelector(this.classHandler),i=s?.checkVisibility(),r=Boolean(s),l=t.target.closest(this.classHandler);r&&i&&!l||(this.pointerStart.clientX=t.clientX,this.pointerStart.clientY=t.clientY,this.elGrabbed=e,this.elGrabbed.setPointerCapture(t.pointerId),this.elParentGrab.style.userSelect="none",this.indexGrab=[...this.elParentGrab.children].indexOf(this.elGrabbed),this.onGrab?.call(this,t))};move=t=>{const{pointerId:e,clientX:s,clientY:i}=t;if(!this.elGrabbed?.hasPointerCapture(e))return;this.isFirstMove||(this.isFirstMove=!0,this.appendGhost({clientX:s,clientY:i}),this.elGrabbed.classList.add("is-jsort-grabbed"));const r=this.checkValidity({clientX:s,clientY:i});this.elGhost.style.translate=`${s-this.pointerStart.clientX}px ${i-this.pointerStart.clientY}px`,this.elGhost.classList.toggle("is-jsort-invalid",!r),this.elGrabbed.style.cursor=r?"grab":"not-allowed";const l=document.elementFromPoint(s,i),n=l?.closest(`${this.classItems}, .jsort`);n!==this.elTarget&&(this.elTarget?.classList.remove("is-jsort-target"),r&&(this.elTarget=n,this.elTarget?.classList.add("is-jsort-target"))),this.handleScrollParent(t),this.onMove?.call(this,t)};drop=t=>{this.stopEdgeScroll();const{pointerId:e,clientX:s,clientY:i}=t;if(!this.elGrabbed?.hasPointerCapture(e))return;this.elParentGrab.style.removeProperty("user-select"),this.elGrabbed.style.removeProperty("cursor"),this.elGrabbed?.classList.remove("is-jsort-grabbed"),this.elTarget?.classList.remove("is-jsort-target");const r=document.elementFromPoint(s,i);this.elTarget=r?.closest(`${this.classItems}, .jsort`),this.elParentDrop=r?.closest(".jsort");const l=this.elParentDrop===this.elParentGrab,n=Boolean(this.elTarget&&this.elParentDrop&&this.elTarget===this.elParentDrop);this.elGhost?.animate([{scale:1}],{duration:0,fill:"forwards"});const o=this.elGhost?.getBoundingClientRect();if(this.checkValidity({clientX:s,clientY:i})){const t=[...this.elParentGrab.children].filter(t=>t!==this.elGhost);if(this.indexGrab=t.indexOf(this.elGrabbed),this.swap)this.affectedItems=[this.elTarget];else if(l){this.indexDrop=n?Math.max(0,t.length-1):t.indexOf(this.elTarget);const e=n?this.indexGrab:Math.min(this.indexDrop,this.indexGrab),s=n?t.length-1:Math.max(this.indexDrop,this.indexGrab);this.affectedItems=t.slice(e,s+1)}else{const e=[...this.elParentDrop.children];this.indexDrop=n?Math.max(0,e.length):e.indexOf(this.elTarget),this.affectedItems=[...t.slice(this.indexGrab),...e.slice(this.indexDrop)]}const e=this.affectedItems.map(t=>{const{x:e,y:s}=t.getBoundingClientRect();return{el:t,x:e,y:s}});if(this.swap){if(!n){const t=this.elGrabbed.nextSibling;this.elParentDrop.insertBefore(this.elGrabbed,this.elTarget.nextSibling),this.elParentGrab.insertBefore(this.elTarget,t)}}else n?this.elParentDrop.append(this.elGrabbed):l?this.elParentDrop.insertBefore(this.elGrabbed,this.indexDrop<this.indexGrab?this.elTarget:this.elTarget.nextSibling):this.elParentDrop.insertBefore(this.elGrabbed,this.elTarget);e.forEach(t=>{t.el!==this.elGrabbed&&this.animateItem(t)})}o&&this.animateItem({el:this.elGrabbed,x:o.left,y:o.top}),this.onDrop?.call(this,t),this.reset()};handleTouchAction=t=>{this.elGrabbed&&t.preventDefault()};reset(){this.elGhost?.remove(),this.elGhost=null,this.elGrabbed=null,this.elTarget=null,this.elParentDrop=null,this.indexGrab=-1,this.indexDrop=-1,this.affectedItems=[],this.pointerStart={},this.isFirstMove=!1,this.scrollParent=null,this.scrollDirection=null,this.scrollAnim=null,this.onGrab=()=>{},this.onMove=()=>{},this.onDrop=()=>{}}init(t){this.destroy(),Object.assign(this,t),this.reset(),this.elParentGrab.addEventListener("touchstart",this.handleTouchAction),this.elParentGrab.addEventListener("pointerdown",this.grab),this.elParentGrab.addEventListener("pointermove",this.move),this.elParentGrab.addEventListener("pointerup",this.drop),this.elParentGrab.addEventListener("pointercancel",this.drop)}destroy(){this.elParentGrab.removeEventListener("touchstart",this.handleTouchAction),this.elParentGrab.removeEventListener("pointerdown",this.grab),this.elParentGrab.removeEventListener("pointermove",this.move),this.elParentGrab.removeEventListener("pointerup",this.drop),this.elParentGrab.removeEventListener("pointercancel",this.drop)}}document.querySelectorAll(".jsort").forEach(e=>{new t(e),e.querySelectorAll(":scope > *").forEach((t,e)=>{t.style.backgroundColor=`hsl(${~~(200*Math.random()+80)} 40% 77%)`})});
