import e from"https://unpkg.com/@highlightjs/cdn-assets@11.11.1/es/highlight.min.js";import t from"https://unpkg.com/@highlightjs/cdn-assets@11.11.1/es/languages/javascript.min.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class s{constructor(e,t){this.elParentGrab=e,this.selectorParent=".jsort",this.selectorItems=".jsort-item",this.selectorHandler=".jsort-handler",this.classAnimated="is-jsort-animated",this.classGrabbed="is-jsort-grabbed",this.classTarget="is-jsort-target",this.classInvalid="is-jsort-invalid",this.easing="cubic-bezier(0.6, 0, 0.6, 1)",this.zIndex=2147483647,this.duration=420,this.opacity=.8,this.scale=1.1,this.swap=!1,this.parentDrop=!0,this.group=null,this.edgeThreshold=50,this.scrollSpeed=10,this.timeoutGrab=250,this.init(t)}parseDataAttribute(e){return e?.dataset.jsort?.replace(/\s/g,"").replace(/;$/,"").split(/;/).reduce((e,t)=>{const[s,i]=t.split(":");return e[s]=isNaN(i)?/^(true|false)$/.test(i)?JSON.parse(i):i:Number(i),e},{})??{}}appendGhost(){const{x:e,y:t,width:s,height:i}=this.elGrabbed.getBoundingClientRect();this.elGhost=this.elGrabbed.cloneNode(!0),Object.assign(this.elGhost.style,{position:"fixed",left:`${e}px`,top:`${t}px`,width:`${s}px`,height:`${i}px`,pointerEvents:"none",zIndex:this.zIndex,opacity:this.opacity}),this.elGhost.classList.add("jsort-ghost"),this.elGhost.animate([{scale:this.scale}],{duration:250,easing:this.easing,fill:"forwards"}),this.elParentGrab.append(this.elGhost)}animateItem({el:e,x:t,y:s}){const{left:i,top:r}=e.getBoundingClientRect();if(t===i&&s===r)return;e.classList.add(this.classAnimated);const l=e===this.elGrabbed?[{position:"relative",zIndex:1,translate:`${t-i}px ${s-r}px`,opacity:.9,scale:this.scale},{position:"relative",zIndex:1,translate:"0",opacity:1,scale:1}]:[{position:"relative",zIndex:0,scale:1,translate:`${t-i}px ${s-r}px`},{position:"relative",zIndex:0,scale:2-this.scale},{position:"relative",zIndex:0,scale:1,translate:"0"}],n=e.animate(l,{duration:this.duration,easing:this.easing,fill:"forwards"});n.addEventListener("finish",()=>{e.classList.remove(this.classAnimated),n.cancel()})}closestElement(e,t){for(;e&&e!==t;)e=e.parentElement;return e===t?e:null}checkValidity({clientX:e,clientY:t}){const s=document.elementFromPoint(e,t),i=s?.closest(`${this.selectorItems}, ${this.selectorParent}`),r=s?.closest(this.selectorParent),l=i===r,n=i&&this.closestElement(i,this.elGrabbed)===this.elGrabbed,o=r===this.elParentGrab,h=r?.dataset.jsortGroup,a=!o&&Boolean(h&&this.group===h);if(!this.parentDrop&&l)return!1;return!n&&i&&r&&a||o}engine(e,t=60){const s=1e3/t;let i=0,r=null;const l=()=>{r=requestAnimationFrame(l);const t=window.performance.now(),n=t-i;if(n<s)return;i=t-n%s,e()},n=()=>{cancelAnimationFrame(r),r=null,i=0};return{start:()=>{n(),i=performance.now(),r=requestAnimationFrame(l)},stop:n,tick:l}}findScrollParent(e){for(;e&&e!==document.documentElement;){const t=getComputedStyle(e);if(e.scrollHeight>e.clientHeight&&/^(auto|scroll)$/.test(t.overflowY))return e;e=e.parentElement}return document.documentElement}scrollStep(){if(!this.scrollDirection)return;const e=this.scrollSpeed*(this.edgePressure/Math.max(this.edgeThreshold,1));"up"===this.scrollDirection?this.scrollParent.scrollTop-=e:"down"===this.scrollDirection?this.scrollParent.scrollTop+=e:"left"===this.scrollDirection?this.scrollParent.scrollLeft-=e:"right"===this.scrollDirection&&(this.scrollParent.scrollLeft+=e)}startEdgeScroll(e){this.scrollDirection!==e&&(this.scrollDirection=e,this.scrollAnim||(this.scrollAnim=this.engine(this.scrollStep.bind(this)),this.scrollAnim.start()))}stopEdgeScroll(){this.scrollDirection=null,this.scrollAnim&&(this.scrollAnim.stop(),this.scrollAnim=null)}handleScrollParent(e){this.scrollParent||(this.scrollParent=this.findScrollParent(this.elGrabbed));const t=this.scrollParent.getBoundingClientRect(),s=document.documentElement,i=this.scrollParent===s,r=i?0:t.top,l=i?window.innerHeight:t.bottom,n=i?0:t.left,o=i?window.innerWidth:t.left;e.clientY<r+this.edgeThreshold?(this.edgePressure=Math.min(this.edgeThreshold,this.edgeThreshold-(e.clientY-r)),this.startEdgeScroll("up")):e.clientY>l-this.edgeThreshold?(this.edgePressure=Math.min(this.edgeThreshold,this.edgeThreshold-(l-e.clientY)),this.startEdgeScroll("down")):e.clientX<n+this.edgeThreshold?(this.edgePressure=Math.min(this.edgeThreshold,this.edgeThreshold-(e.clientX-n)),this.startEdgeScroll("left")):e.clientX>o-this.edgeThreshold?(this.edgePressure=Math.min(this.edgeThreshold,this.edgeThreshold-(o-e.clientX)),this.startEdgeScroll("right")):this.stopEdgeScroll()}grab=e=>{if(this.elGrabbed)return;const t=e.target.closest(`${this.selectorItems}`);if(!t)return;if(t.parentElement!==this.elParentGrab)return;const s=t.querySelector(this.selectorHandler),i=s?.checkVisibility(),r=Boolean(s),l=e.target.closest(this.selectorHandler);r&&i&&!l||(this.pointerStart.clientX=e.clientX,this.pointerStart.clientY=e.clientY,this.elGrabbed=t,this.elParentGrab.style.userSelect="none",this.indexGrab=[...this.elParentGrab.children].indexOf(this.elGrabbed),this.elGrabbed.setPointerCapture(e.pointerId),this.onGrab?.call(this,e),"mouse"===e.pointerType&&(this.preventScroll=!0))};move=e=>{const{pointerId:t,clientX:s,clientY:i}=e;if(!this.preventScroll||!this.elGrabbed?.hasPointerCapture(t))return;this.isFirstMove||(this.isFirstMove=!0,this.appendGhost({clientX:s,clientY:i}),this.elGrabbed.classList.add(this.classGrabbed));const r=this.checkValidity({clientX:s,clientY:i});this.elGhost.style.translate=`${s-this.pointerStart.clientX}px ${i-this.pointerStart.clientY}px`,this.elGhost.classList.toggle(this.classInvalid,!r),this.elGrabbed.style.cursor=r?"grab":"not-allowed";const l=document.elementFromPoint(s,i),n=l?.closest(`${this.selectorItems}, ${this.selectorParent}`);n!==this.elTarget&&(this.elTarget?.classList.remove(this.classTarget),r&&(this.elTarget=n,this.elTarget?.classList.add(this.classTarget))),this.handleScrollParent(e),this.onMove?.call(this,e)};drop=e=>{this.stopEdgeScroll(),this.preventScroll=!1;const{pointerId:t,clientX:s,clientY:i}=e;if(!this.elGrabbed?.hasPointerCapture(t))return;this.elParentGrab.style.removeProperty("user-select"),this.elGrabbed.style.removeProperty("cursor"),this.elGrabbed?.classList.remove(this.classGrabbed),this.elTarget?.classList.remove(this.classTarget);const r=document.elementFromPoint(s,i);this.elTarget=r?.closest(`${this.selectorItems}, ${this.selectorParent}`),this.elParentDrop=r?.closest(this.selectorParent);const l=this.elParentDrop===this.elParentGrab,n=Boolean(this.elTarget&&this.elParentDrop&&this.elTarget===this.elParentDrop);this.elGhost?.animate([{scale:1}],{duration:0,fill:"forwards"});const o=this.elGhost?.getBoundingClientRect();if(this.checkValidity({clientX:s,clientY:i})){const e=[...this.elParentGrab.children].filter(e=>e!==this.elGhost);if(this.indexGrab=e.indexOf(this.elGrabbed),this.swap)this.affectedItems=[this.elTarget];else if(l){this.indexDrop=n?Math.max(0,e.length-1):e.indexOf(this.elTarget);const t=n?this.indexGrab:Math.min(this.indexDrop,this.indexGrab),s=n?e.length-1:Math.max(this.indexDrop,this.indexGrab);this.affectedItems=e.slice(t,s+1)}else{const t=[...this.elParentDrop.children];this.indexDrop=n?Math.max(0,t.length):t.indexOf(this.elTarget),this.affectedItems=[...e.slice(this.indexGrab),...t.slice(this.indexDrop)]}const t=this.affectedItems.map(e=>{const{x:t,y:s}=e.getBoundingClientRect();return{el:e,x:t,y:s}});if(this.swap){if(!n){const e=this.elGrabbed.nextSibling;this.elParentDrop.insertBefore(this.elGrabbed,this.elTarget.nextSibling),this.elParentGrab.insertBefore(this.elTarget,e)}}else n?this.elParentDrop.append(this.elGrabbed):l?this.elParentDrop.insertBefore(this.elGrabbed,this.indexDrop<this.indexGrab?this.elTarget:this.elTarget.nextSibling):this.elParentDrop.insertBefore(this.elGrabbed,this.elTarget);t.forEach(e=>{e.el!==this.elGrabbed&&this.animateItem(e)})}o&&this.animateItem({el:this.elGrabbed,x:o.left,y:o.top}),this.onDrop?.call(this,e),this.reset()};handleTouchStart=()=>{this.moveTimeout=setTimeout(()=>{this.preventScroll=!0,this.elGrabbed?.classList.add(this.classGrabbed)},this.timeoutGrab)};handleTouchMove=e=>{this.elGrabbed&&(this.moveTimeout&&(clearTimeout(this.moveTimeout),this.moveTimeout=null),this.preventScroll&&e.preventDefault())};reset(){this.elGhost?.remove(),this.elGhost=null,this.elGrabbed=null,this.elTarget=null,this.elParentDrop=null,this.indexGrab=-1,this.indexDrop=-1,this.affectedItems=[],this.pointerStart={},this.isFirstMove=!1,this.scrollParent=null,this.scrollDirection=null,this.scrollAnim=null,this.edgePressure=0,this.moveTimeout=null,this.preventScroll=!1,this.onGrab=()=>{},this.onMove=()=>{},this.onDrop=()=>{}}init(e){this.destroy();const t=this.parseDataAttribute(this.elParentGrab);Object.assign(this,e,t),this.reset(),this.elParentGrab.addEventListener("touchstart",this.handleTouchStart),this.elParentGrab.addEventListener("touchmove",this.handleTouchMove),this.elParentGrab.addEventListener("pointerdown",this.grab),this.elParentGrab.addEventListener("pointermove",this.move),this.elParentGrab.addEventListener("pointerup",this.drop),this.elParentGrab.addEventListener("pointercancel",this.drop),this.elParentGrab.dataset.jsortGroup=this.group}destroy(){this.elParentGrab.removeEventListener("touchstart",this.handleTouchStart),this.elParentGrab.removeEventListener("touchmove",this.handleTouchMove),this.elParentGrab.removeEventListener("pointerdown",this.grab),this.elParentGrab.removeEventListener("pointermove",this.move),this.elParentGrab.removeEventListener("pointerup",this.drop),this.elParentGrab.removeEventListener("pointercancel",this.drop)}}e.registerLanguage("javascript",t),document.querySelectorAll(".jsort").forEach(e=>{new s(e),e.querySelectorAll(":scope > *").forEach((e,t)=>{e.style.backgroundColor=`hsl(${~~(200*Math.random()+80)} 56% 65%)`})}),document.querySelectorAll("pre > code").forEach(t=>{e.highlightElement(t)});
