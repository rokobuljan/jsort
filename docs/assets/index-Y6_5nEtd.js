import t from"https://unpkg.com/@highlightjs/cdn-assets@11.11.1/es/highlight.min.js";import e from"https://unpkg.com/@highlightjs/cdn-assets@11.11.1/es/languages/javascript.min.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();
/**
 * @class JSort
 * @author Roko C. Buljan <https://github.com/rokobuljan>
 * @license MIT
 * @description Small yet powerful drag and drop sortable library with touch support, smooth animations, for a great UX.
 * @see {@link https://github.com/rokobuljan/jsort}
 */
class s{static version="1.6.6";elGhost;elGrabbed;elTarget;elDrop;elDropParent;indexGrab=-1;indexDrop=-1;affectedItems=[];pointerStart={};isFirstMove=!1;scrollParent=null;scrollDirection=null;scrollAnim=null;edgePressure=0;moveTimeout;preventScroll=!1;hasMoved=!1;initialTouch=null;constructor(t,e={}){this.elGrabParent=t,this.group="",this.swap=!1,this.duration=420,this.easing="cubic-bezier(0.6, 0, 0.6, 1)",this.scale=1.1,this.opacity=.8,this.grabTimeout=140,this.parentDrop=!0,this.dragThreshold=8,this.edgeThreshold=50,this.scrollSpeed=10,this.zIndex=2147483647,this.selectorParent=".jsort",this.selectorItems=".jsort-item",this.selectorHandler=".jsort-handler",this.classGhost="is-jsort-ghost",this.classActive="is-jsort-active",this.classTouch="is-jsort-touch",this.classGrabbed="is-jsort-grabbed",this.classTarget="is-jsort-target",this.classAnimated="is-jsort-animated",this.classAnimatedDrop="is-jsort-animated-drop",this.classInvalid="is-jsort-invalid",this.onBeforeGrab=()=>{},this.onGrab=()=>{},this.onMove=()=>{},this.onBeforeDrop=()=>{},this.onDrop=()=>{},this.onAnimationEnd=()=>{},this.init(e)}parseDataAttribute(t){return t?.dataset.jsort?.replace(/\s/g,"").replace(/;$/,"").split(/;/).reduce((t,e)=>{const[s,i]=e.split(":");return t[s]=isNaN(Number(i))?/^(true|false)$/.test(i)?JSON.parse(i):i:Number(i),t},{})??{}}appendGhost(){if(!this.elGrabbed)return;const{x:t,y:e,width:s,height:i}=this.elGrabbed.getBoundingClientRect();this.elGhost=this.elGrabbed.cloneNode(!0),Object.assign(this.elGhost.style,{position:"fixed",left:`${t}px`,top:`${e}px`,width:`${s}px`,height:`${i}px`,pointerEvents:"none",zIndex:this.zIndex,opacity:this.opacity}),this.elGhost.classList.remove(this.classActive),this.elGhost.classList.add(this.classGhost),this.elGhost.animate([{scale:this.scale}],{duration:250,easing:this.easing,fill:"forwards"}),this.elGrabParent.append(this.elGhost)}removeGhost(){this.elGhost&&(this.elGhost.remove(),this.elGhost=null)}animateItem({el:t,x:e,y:s}){const{left:i,top:r}=t.getBoundingClientRect();if(e===i&&s===r)return;t.classList.add(this.classAnimated);const l=t===this.elGrabbed?[{position:"relative",zIndex:1,translate:`${e-i}px ${s-r}px`,opacity:.9,scale:this.scale},{position:"relative",zIndex:1,translate:"0",opacity:1,scale:1}]:[{position:"relative",zIndex:0,scale:1,translate:`${e-i}px ${s-r}px`},{position:"relative",zIndex:0,scale:2-this.scale},{position:"relative",zIndex:0,scale:1,translate:"0"}],o=t.animate(l,{duration:this.duration,easing:this.easing,fill:"forwards"});return o.addEventListener("finish",()=>{t.classList.remove(this.classAnimated),o.cancel()}),o}closestElement(t,e){for(;t&&t!==e;)t=t.parentElement;return t===e?t:null}checkValidity({clientX:t,clientY:e}){const s=document.elementFromPoint(t,e),i=s?.closest(`${this.selectorItems}, ${this.selectorParent}`),r=s?.closest(this.selectorParent),l=i===r,o=i&&this.closestElement(i,this.elGrabbed)===this.elGrabbed,n=r===this.elGrabParent,h=r?.dataset.jsortGroup,a=!n&&Boolean(h&&this.group===h);if(!this.parentDrop&&l)return!1;return!o&&i&&r&&a||n}engine(t,e=60){const s=1e3/e;let i=0,r=null;const l=()=>{r=requestAnimationFrame(l);const e=window.performance.now(),o=e-i;if(o<s)return;i=e-o%s,t()},o=()=>{cancelAnimationFrame(r),r=null,i=0};return{start:()=>{o(),i=performance.now(),r=requestAnimationFrame(l)},stop:o,tick:l}}findScrollParent(t){for(;t&&t!==document.documentElement;){const e=getComputedStyle(t);if(t.scrollHeight>t.clientHeight&&/^(auto|scroll)$/.test(e.overflowY))return t;t=t.parentElement}return document.documentElement}scrollStep(){if(!this.scrollDirection||!this.scrollParent)return;const t=this.scrollSpeed*(this.edgePressure/Math.max(this.edgeThreshold,1));"up"===this.scrollDirection?this.scrollParent.scrollTop-=t:"down"===this.scrollDirection?this.scrollParent.scrollTop+=t:"left"===this.scrollDirection?this.scrollParent.scrollLeft-=t:"right"===this.scrollDirection&&(this.scrollParent.scrollLeft+=t)}startEdgeScroll(t){this.scrollDirection!==t&&(this.scrollDirection=t,this.scrollAnim||(this.scrollAnim=this.engine(this.scrollStep.bind(this)),this.scrollAnim?.start()))}stopEdgeScroll(){this.scrollDirection=null,this.scrollAnim&&(this.scrollAnim.stop(),this.scrollAnim=null)}handleScrollParent(t){this.scrollParent||(this.scrollParent=this.findScrollParent(this.elGrabbed));const e=this.scrollParent.getBoundingClientRect(),s=document.documentElement,i=this.scrollParent===s,r=i?0:e.top,l=i?window.innerHeight:e.bottom,o=i?0:e.left,n=i?window.innerWidth:e.left;t.clientY<r+this.edgeThreshold?(this.edgePressure=Math.min(this.edgeThreshold,this.edgeThreshold-(t.clientY-r)),this.startEdgeScroll("up")):t.clientY>l-this.edgeThreshold?(this.edgePressure=Math.min(this.edgeThreshold,this.edgeThreshold-(l-t.clientY)),this.startEdgeScroll("down")):t.clientX<o+this.edgeThreshold?(this.edgePressure=Math.min(this.edgeThreshold,this.edgeThreshold-(t.clientX-o)),this.startEdgeScroll("left")):t.clientX>n-this.edgeThreshold?(this.edgePressure=Math.min(this.edgeThreshold,this.edgeThreshold-(n-t.clientX)),this.startEdgeScroll("right")):this.stopEdgeScroll()}grab=t=>{if(this.elGrabbed)return;const e=t.target,s=e.closest(`${this.selectorItems}`);if(!s)return;if(s.parentElement!==this.elGrabParent)return;const i=s.querySelector(this.selectorHandler),r=i?.checkVisibility(),l=Boolean(i),o=e?.closest(this.selectorHandler);if(l&&r&&!o)return;this.pointerStart.clientX=t.clientX,this.pointerStart.clientY=t.clientY,this.elGrabbed=s,this.elGrabbed.setPointerCapture(t.pointerId),this.elGrabbed.classList.add(this.classActive),this.elGrabbed.style.cursor="move",this.elGrabParent.style.userSelect="none",this.indexGrab=[...this.elGrabParent.children].indexOf(this.elGrabbed);this.onBeforeGrab?.call(this,t)??!0?(this.onGrab?.call(this,t),"mouse"===t.pointerType&&(this.preventScroll=!0)):this.reset()};move=t=>{const{pointerId:e,clientX:s,clientY:i}=t;if(!this.preventScroll||!this.elGrabbed?.hasPointerCapture(e))return;this.isFirstMove||(this.isFirstMove=!0,this.appendGhost(),this.elGrabbed.classList.add(this.classGrabbed));const r=this.checkValidity({clientX:s,clientY:i});this.elGhost&&(this.elGhost.style.translate=`${s-this.pointerStart.clientX}px ${i-this.pointerStart.clientY}px`,this.elGhost.classList.toggle(this.classInvalid,!r)),this.elGrabbed.style.cursor=r?"grab":"not-allowed";const l=document.elementFromPoint(s,i),o=l?.closest(`${this.selectorItems}, ${this.selectorParent}`);o!==this.elTarget&&(this.elTarget?.classList.remove(this.classTarget),r&&(this.elTarget=o,this.elTarget?.classList.add(this.classTarget))),this.handleScrollParent(t),this.onMove?.call(this,t)};drop=t=>{this.stopEdgeScroll(),this.preventScroll=!1;const{pointerId:e,clientX:s,clientY:i}=t;if(!this.elGrabbed||!this.elGrabbed?.hasPointerCapture(e))return;this.elGrabParent.style.removeProperty("user-select"),this.elGrabbed.style.removeProperty("cursor"),this.elGrabbed.classList.remove(this.classActive,this.classGrabbed,this.classTouch),this.elTarget?.classList.remove(this.classTarget);const r=document.elementFromPoint(s,i);this.elDrop=r?.closest(`${this.selectorItems}, ${this.selectorParent}`),this.elDropParent=r?.closest(this.selectorParent),this.elGhost?.animate([{scale:1}],{duration:0,fill:"forwards"});const l=this.elGhost?.getBoundingClientRect();if(this.checkValidity({clientX:s,clientY:i})){const e=this.elDropParent===this.elGrabParent,s=Boolean(this.elDrop&&this.elDropParent&&this.elDrop===this.elDropParent),i=[...this.elGrabParent.children].filter(t=>t!==this.elGhost);if(this.indexGrab=i.indexOf(this.elGrabbed),this.swap)this.affectedItems=this.elDrop?[this.elDrop]:[];else if(e){this.indexDrop=s?Math.max(0,i.length-1):this.elDrop?i.indexOf(this.elDrop):-1;const t=s?this.indexGrab:Math.min(this.indexDrop,this.indexGrab),e=s?i.length-1:Math.max(this.indexDrop,this.indexGrab);this.affectedItems=i.slice(t,e+1)}else{const t=this.elDropParent?.children,e=t?[...t]:[];this.indexDrop=s?Math.max(0,e.length):this.elDrop?e.indexOf(this.elDrop):-1,this.affectedItems=[...i.slice(this.indexGrab),...e.slice(this.indexDrop)]}const r=this.affectedItems.map(t=>{const{x:e,y:s}=t.getBoundingClientRect();return{el:t,x:e,y:s}});if(this.onBeforeDrop?.call(this,t)??!0){if(this.swap){if(!s&&this.elDrop){const t=this.elGrabbed.nextSibling;this.elDropParent?.insertBefore(this.elGrabbed,this.elDrop.nextSibling),this.elGrabParent?.insertBefore(this.elDrop,t)}}else s?this.elDropParent?.append(this.elGrabbed):e&&this.elDrop?this.elDropParent?.insertBefore(this.elGrabbed,this.indexDrop<this.indexGrab?this.elDrop:this.elDrop.nextSibling):this.elDropParent?.insertBefore(this.elGrabbed,this.elDrop);this.onDrop?.call(this,t)}r.forEach(t=>{t.el!==this.elGrabbed&&this.animateItem(t)})}if(l){const e=this.elGrabbed;e.classList.add(`${this.classAnimatedDrop}`);const s=this.animateItem({el:e,x:l.left,y:l.top});s?s.addEventListener("finish",()=>{e.classList.remove(`${this.classAnimatedDrop}`),this.onAnimationEnd?.call(this,t)}):e.classList.remove(`${this.classAnimatedDrop}`)}this.removeGhost(),this.reset()};handleTouchStart=t=>{if(!this.elGrabbed||this.initialTouch)return;const{clientX:e,clientY:s}=t.touches[0];this.initialTouch={clientX:e,clientY:s},this.moveTimeout&&clearTimeout(this.moveTimeout),this.moveTimeout=setTimeout(()=>{this.hasMoved||(this.elGrabbed?.classList.add(`${this.classTouch}`),this.preventScroll=!0)},this.grabTimeout)};handleTouchMove=t=>{if(!this.elGrabbed||!this.initialTouch)return;if(this.preventScroll)return void t.preventDefault();const{clientX:e,clientY:s}=t.touches[0],i=e-this.initialTouch.clientX,r=s-this.initialTouch.clientY,l=Math.hypot(i,r)>this.dragThreshold&&!this.hasMoved;!this.hasMoved&&l&&(this.hasMoved=!0,clearTimeout(this.moveTimeout),this.moveTimeout=void 0)};reset(){this.elGhost=null,this.elGrabbed=null,this.elTarget=null,this.elDrop=null,this.elDropParent=null,this.indexGrab=-1,this.indexDrop=-1,this.affectedItems=[],this.pointerStart={},this.isFirstMove=!1,this.scrollParent=null,this.scrollDirection=null,this.scrollAnim=null,this.edgePressure=0,this.moveTimeout=void 0,this.preventScroll=!1,this.hasMoved=!1,this.initialTouch=null}init(t){this.destroy();const e=this.parseDataAttribute(this.elGrabParent);Object.assign(this,t,e),this.reset(),this.elGrabParent.addEventListener("touchstart",this.handleTouchStart),this.elGrabParent.addEventListener("touchmove",this.handleTouchMove),this.elGrabParent.addEventListener("pointerdown",this.grab),this.elGrabParent.addEventListener("pointermove",this.move),this.elGrabParent.addEventListener("pointerup",this.drop),this.elGrabParent.addEventListener("pointercancel",this.drop),this.elGrabParent.dataset.jsortGroup=this.group}destroy(){this.removeGhost(),this.elGrabParent.removeEventListener("touchstart",this.handleTouchStart),this.elGrabParent.removeEventListener("touchmove",this.handleTouchMove),this.elGrabParent.removeEventListener("pointerdown",this.grab),this.elGrabParent.removeEventListener("pointermove",this.move),this.elGrabParent.removeEventListener("pointerup",this.drop),this.elGrabParent.removeEventListener("pointercancel",this.drop)}}t.registerLanguage("javascript",e),document.querySelector("#version").textContent=`${s.version}`,console.log(`Running JSort version: ${s.version}`),document.querySelectorAll(".jsort").forEach(t=>{new s(t),t.querySelectorAll(":scope > *").forEach(t=>{t.style.backgroundColor=`hsl(${~~(200*Math.random()+80)} 56% 65%)`})}),document.querySelectorAll("pre > code").forEach(e=>{t.highlightElement(e)});
